# Clean Code 

## ch 9 단위테스트

TDD 의 법칙 세가지

1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파잃은 실패하지 않으면서 실행이 실패하는 정도만 단위 테스트를 진행한다. 
3. 현재 실패하는 테스트를 토과할 정도로만 실제 코드를 작성한다.

이렇게 매일 코드를 작성할 때 마다 위의 법칙을 상기하면서 테스트를 작성해야 한다. 그렇다면 어떻게 작성하면 좋을까? 무조건 "깨끗하게" 해야한다. 그렇지 않으면 결국 안하느니만 못하는 상황이 벌어질 것이다.



생각을 해보자. 테스트를 진행 했을때 코드의 변경으로 인해서 어느 순간에는 실패가 일어날 수 있다. 이때 테스트 코드가 지저분해서 코드를 파악하는데 시간이 걸리거나, 수정을 했는데 다른 쪽에 문제가 생기는 경우는 테스트를 안하느니만 못한 것이다. 테스트 코드를 작성했는데 오히려 짐이 되버리는 경우이다. 테스트 코드는 실제 코드 못지 않게 중요하다는 점을 인지하자.



그렇다면 이런 테스트를 왜 할까? 테스트는 유연성, 유지보수성, 재사용성을 제공한다. 물론 위에서 말한 테스트코드를 깔끔하게 유지한다는 것이 조건이다. 테스트를 하게 되면 내가 어떤 변경을 하더라도 이에 대한 사이드 이펙트에 대해서 알아서 잡아준다. 즉, 더 나은 환경을 위해서 고치고 싶은 부분을 마음대로 고칠 수 있다는 것이다. 



그렇다면 테스트는 어떤 방식으로 작성할까? 위에서 언급한 TDD법칙 세가지와 더불어 책에서는 이런 내용을 강조하였다. 가독성, 각 함수당 하나의 개념이 있으며 그 외에도 FIRST 라는 법칙이 있는데 이는 아래와 같다.

- Fast : 빨라야 한다.  자주 돌리고 확인을 해야하기 때문이다.
- Independent : 각 테스트는 서로 의존해서는 안된다. 어떤 순서로 실행해도 각 로직이 겹쳐서는 안된다.
- Repeatable : 어떤 환경에서도 반복 가능해야 한다. 어떤 환경이 문제가 되는 순간 그 환경을 탓하기 시작하기 때문이다.
- Self-Validating : 로그를 통해서 성공과 실패가 좌우 되어서는 안된다. P/F 로 명확하게 답이 나와야 한다.
- Timely : 테스트 하려는 실제 코드가 만들어지기 전에 작성해야 한다. 실제로 코드를 작성하고 나서 테스트를 하려면 생각보다 어려울 수 있기 때문이다. 



테스트 코드는 프로젝트의 건강에 중요한 부분이다. 꼭 짚고 넘어가도록 하자.



